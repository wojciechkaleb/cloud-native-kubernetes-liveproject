apiVersion: v1
kind: Secret
metadata:
  name: sns-tls-secret
type: kubernetes.io/tls
data:
  tls.crt: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUU4VENDQTFtZ0F3SUJBZ0lSQUpXQzFPejRhWldqak04UU12U3FyYVV3RFFZSktvWklodmNOQVFFTEJRQXcKZ2NreEhqQWNCZ05WQkFvVEZXMXJZMlZ5ZENCa1pYWmxiRzl3YldWdWRDQkRRVEZQTUUwR0ExVUVDd3hHZDI5cQpZMmxsWTJocllXeGxZbUZ6YVdGclFGZHZhbU5wWldOb2N5MU5ZV05DYjI5ckxWQnlieTVzYjJOaGJDQW9WMjlxClkybGxZMmdnUzJIRmdzU1pZbUZ6YVdGcktURldNRlFHQTFVRUF3eE5iV3RqWlhKMElIZHZhbU5wWldOb2EyRnMKWldKaGMybGhhMEJYYjJwamFXVmphSE10VFdGalFtOXZheTFRY204dWJHOWpZV3dnS0ZkdmFtTnBaV05vSUV0aAp4WUxFbVdKaGMybGhheWt3SGhjTk1qVXhNREUyTVRneU9EUXpXaGNOTWpnd01URTJNVGt5T0RReldqQjZNU2N3CkpRWURWUVFLRXg1dGEyTmxjblFnWkdWMlpXeHZjRzFsYm5RZ1kyVnlkR2xtYVdOaGRHVXhUekJOQmdOVkJBc00KUm5kdmFtTnBaV05vYTJGc1pXSmhjMmxoYTBCWGIycGphV1ZqYUhNdFRXRmpRbTl2YXkxUWNtOHViRzlqWVd3ZwpLRmR2YW1OcFpXTm9JRXRoeFlMRW1XSmhjMmxoYXlrd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3CmdnRUtBb0lCQVFEVHBSMUVGZkIzcEk4K21ldWUvRGdZQVA2T1NCRWhjVVB3UXZuUXEvcUtBR1krRDVXVzl5VHYKeHNVdWU1Y3l0UVcxRzZpZHVURzB6NHlaWmY1MkFNREFkOWJKcDU5R2ZIL1VhbkxESG5LVURYNWlpMDRtazFIVQo5VW1QMFM0SE51WmhsNUFhK2loSXA3OS9VOVhoOXhxVW82eXBIY2JwMlhHQVRkbWk2YXN4S2xFU1V3anhtWVA2CnZlMHJDcFEyc1FSdjdKWmM2S0pUZjQybVZnZTM1M1VoMitOcDRyNDVMdkNHck5udU9mUS8yZmVsRC9qd0hIaGwKbjNLRWZYY05PQWVyU3FVMzk4VnhkZTcyZmdzS3c1eTRlWWJMRjlZeS9SUjJ0ckVRZDZFV3pNTzRXWVo3bTdCQgpBQ0pkMXVhVml0YVcxY1p1YlgyOU42T2RhNTNOcjhZaEFnTUJBQUdqZ2FFd2daNHdEZ1lEVlIwUEFRSC9CQVFECkFnV2dNQk1HQTFVZEpRUU1NQW9HQ0NzR0FRVUZCd01CTUI4R0ExVWRJd1FZTUJhQUZHdDIvWElpSi9lcUtqZWoKZTVPY1hRZ0Jsd0lsTUZZR0ExVWRFUVJQTUUyQ0MyVjRZVzF3YkdVdVkyOXRnZzBxTG1WNFlXMXdiR1V1WTI5dApnZ3hsZUdGdGNHeGxMblJsYzNTQ0NXeHZZMkZzYUc5emRJY0Vmd0FBQVljUUFBQUFBQUFBQUFBQUFBQUFBQUFBCkFUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FZRUFwb3RkcnZtcFkzbmN1WWhvNkE1Ry9FQ2xiZTVpamJVbEtOZDAKZFcwTGUvV09ib3ViSVd1YlkzL0Y1dktEaXgvd3dtaXF6ajhtb0d5US9Id0hxemNpUjJHZnpwNUNHUXJqa0ViMworcUU2d3M5ZGU5UGlibC9za2p3K3BOSVB0MlA5QTNydllpaXNYSkYwelAvN2RHdnBnMkhlREliOWNnd0l1a05ECk5mOE9HbURmR3FHcFpoM2hVMnloWkJYc1VtTWtqMFhEQnMvTlpLeVMwbk1FZGV1NFVWK0VJaDQxRUpSMHV3RncKa0NxKzJTUi9uOTFxa0ZnaFFJWWIrdU5vVi85ZlNGUDN2L1k5WVc3cjhVMFRpOXVPMmlub01FdmNwZ0c5eTJXaQpGM0tLcmZXS3J1eWNQUGlDeWJiZnNyYlBCWEtwY2ZzUEJ3dEloYVl0OGlwL3pPR09lWmFjR0w4d1NwbmVDMkF0CnJIWHlXM0N4SlhjMWNaVEF4WitPVmNJRlprUXZGOWI4YnpmWTRlVTEvZUwvZTk2ZE5vcHNsanJ3aE54NjIyZGcKM3BickhwTFEzNjFsaFRQeEhVc2xtNXlCN2VGTy9WaFQ2eEczWWZPZTFvbUFIdUJPU0U0UmtRTmlRZUVsUlR5ZQppRzJqT2RtdVFtMTV5bWh6SjN0UUh1OEs5dFpSCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K" 
  tls.key: "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRRFRwUjFFRmZCM3BJOCsKbWV1ZS9EZ1lBUDZPU0JFaGNVUHdRdm5RcS9xS0FHWStENVdXOXlUdnhzVXVlNWN5dFFXMUc2aWR1VEcwejR5WgpaZjUyQU1EQWQ5YkpwNTlHZkgvVWFuTERIbktVRFg1aWkwNG1rMUhVOVVtUDBTNEhOdVpobDVBYStpaElwNzkvClU5WGg5eHFVbzZ5cEhjYnAyWEdBVGRtaTZhc3hLbEVTVXdqeG1ZUDZ2ZTByQ3BRMnNRUnY3SlpjNktKVGY0Mm0KVmdlMzUzVWgyK05wNHI0NUx2Q0dyTm51T2ZRLzJmZWxEL2p3SEhobG4zS0VmWGNOT0FlclNxVTM5OFZ4ZGU3MgpmZ3NLdzV5NGVZYkxGOVl5L1JSMnRyRVFkNkVXek1PNFdZWjdtN0JCQUNKZDF1YVZpdGFXMWNadWJYMjlONk9kCmE1M05yOFloQWdNQkFBRUNnZ0VBYmQ3YmtJcnJLTkV1NDhxMy9QTG1rOStBUnBDM0ErdHUzMzJGZm9TcExaY0QKZk5oT1NlN0hLQXJDTmwxR29yWkMza0FiaXJXblRqd291MEd0bGNqU1I1aHUwb1RJTktsUkd3NmZ3UmMvV0FpaApRYnNidVA3bGptNC8zLzh4cStFZVBDK1lTY2p2dkxnSXU2cmo3OGg5N2dnQ0RGRS9BQXMzMXVtVFAvV2FQNHpNClZwOWlkOHFISUlmSTl5dmJSVTJZWmlHdEFrTnJHZzZFNXdBWG1DRTFzRlRlVitReHVHTVU0SExQMmdKMkxOV1cKQWkrbUp4d0NKbm00aGZjYnlKTkVhWCt1VEMrcjIxVVBIOEdMOFloMTNWTDAyNUtVOXdjcm1NWnFoL21vUmlZUgpjdktyYStYWjQrTzdERy83MEkzQ0NsNzNmdkVSU0JSd2VHTnpDaFo4Z1FLQmdRRGVSK2RESHdvbEN1TVZNMnVaClJ4Tm4vZS92VHlETGxqMFcraWZ4bmFwNVRtcEg1NGZHSkFwdmJJV21sUGNFVTBJejNlbVNSTnZJQlZqK1p4Y0oKbWN5ZTA5dXUrVG5vQnFGTUI0ZWNNYXZDY0huVERnNy8ra2NaeTd6QkVYQ2pWK2dkbWtKL2phSHlJRFI5K3BIZgpIVkNYOWpsWTVUUkNTRm9rV3RhbUxSTnF1UUtCZ1FEendDeTFlR2lWR3czTnVnaXlYRThHNjJyZERPZVJLOXV6CmdTMWp2VExmUUUzL0NjTlNoZkhMWDNpNEh0NWd1TzVkcSszRXozSE11WlBVRmRGeGlCTDFhTWJkZWF5U3ZIY0sKOGxRZHBtdDhKcDBoRk1LRi8yN2FQTTFHNnJIUHZmajd0WWNyaWl6dEhRR0ducElBMitwM0I4ZXVFVFB1N0Z0bwpucnBpTlYvaXFRS0JnUUM3NzhsOXU5bkU5ZzZIMTJFTFNNZ0VyZlRXdm0xNUZMNzBGVy8rWHBOTFcxeUxEUnlFCkQrYnV6SyszNTgxdXo4Snl2aGNGUDhrZnRqM0hZM3hiOXJqR05WUlIvWkRUTi8vYW02Y3lEZUV1VmhENnZMRTgKQnUxa3h4a0JtSEJHKzBWYStobHRaVi9lcXhJV3pldlYzQ0JQUzdTekQ1Lyt4dFBJVnpHVGNSc3dxUUtCZ0FqMwptZTEzSjRuTXUvNUVpTXRlLy8xR0xlRkI5MGJzOFNFeWNHUUo4dFFwdm5UU2ZDQU9FMjRpN2dNQUI3aFJOVnUyCjFvRjJERDYyMlF4bFhSWXJKbDltNG1JRmR1YlREaUlWOWlnOUZoazBKbld3R05QcktMM1luTWl1RzZxRDE2UVMKOG8wVWdVQ2IzNUYvUmVuSUxXRUJwVVB2R0JVREZ2M0xVUm9KMHFRNUFvR0JBTGd3N0JLTG01azhkL2FDSm5IRQpXeWVHNmJwZDFQZTRpc2RKcUk3VUtsZEo5dVNjYU4ra0w2Vm8xd2k4cU5kVUh6NDZGV0tWZk9PeEJRcTBFTGpxCjQ5cldxVzhaNVVaQTNhOXpJM2tSY2ZPaGN1eWpscGdJOUtLaXBIbURWb2QyY204RnVpUDY5ZmpLcnJ3SHZRNHEKQnhWdW51VzByenlhditKNjNsRGtLRkE4Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K"
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: sns-ingress
  annotations:
    nginx.ingress.kubernetes.io/use-regex: "true"
    nginx.ingress.kubernetes.io/rewrite-target: /$2
spec:
  ingressClassName: nginx
  tls:
  - hosts:
    - localhost
    secretName: sns-tls-secret
  rules:
  - host: localhost
    http:
      paths:
      - path: /payment(/|$)(.*)
        pathType: ImplementationSpecific
        backend:
          service:
            name: payment
            port:
              number: 3000
      - path: /subscriptions(/|$)(.*)
        pathType: ImplementationSpecific
        backend:
          service:
            name: subscriptions
            port:
              number: 3001

